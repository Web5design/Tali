<html>
<head>
  <title>WIP</title>
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
  <script src="/lib/jquery.cookie.js"></script>
  <script>
    var socket = io.connect('http://localhost')

    socket.on('connecting', function() {
      console.log('Connecting...')
      socket.emit('token', getEID())
    })

    socket.on('disconnect', function() {
      console.log('DC')
    })
    function getEID (argument) {
      var eID = $.cookie('eID')
      var first = false
      if (!eID) {
        first = true
        eID = genToken()
        $.cookie('eID', eID, 365)
      }
      return {'first':first, 'token':eID}
    }
    function genToken() {
      var token = ''
      var loops = 8
      var targetLength = 48
      var useOfRandom = Math.pow(2,31)
      while (token.length <= targetLength) {
        token += (Math.random()*useOfRandom|0).toString(36)
      }
      return token.substring(0, targetLength)
    }
  </script>
</head>
<body>
  Üdvözlégy Mária!
</body>
</html>
